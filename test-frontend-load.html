<!DOCTYPE html>
<html>
<head>
  <title>Frontend API Test</title>
</head>
<body>
  <h1>Testing Frontend Data Loading</h1>
  <div id="results"></div>

  <script>
    const resultsDiv = document.getElementById('results');

    async function testDataLoading() {
      try {
        resultsDiv.innerHTML = '<p>Testing graph API...</p>';

        // Test exactly what the frontend does
        const baseUrl = 'http://localhost:8084';

        const [nodesResponse, edgesResponse] = await Promise.all([
          fetch(`${baseUrl}/api/graph/nodes?limit=500`),
          fetch(`${baseUrl}/api/graph/edges?limit=5000`)
        ]);

        const nodesData = await nodesResponse.json();
        const edgesData = await edgesResponse.json();

        const html = `
          <h2>âœ… API Response:</h2>
          <ul>
            <li>Nodes loaded: <strong>${nodesData.nodes?.length || 0}</strong></li>
            <li>Edges loaded: <strong>${edgesData.edges?.length || 0}</strong></li>
            <li>First node type: ${nodesData.nodes?.[0]?.metadata?.node_type}</li>
            <li>First edge type: ${edgesData.edges?.[0]?.edge_type}</li>
          </ul>

          <h2>After conversion (as frontend does):</h2>
          <ul>
            <li>All nodes would be type: 'track'</li>
            <li>All edges would be type: 'adjacency'</li>
            <li>Expected nodes in graph: <strong>${nodesData.nodes?.length || 0}</strong></li>
          </ul>

          <p>If the frontend is showing only 45 nodes, it's falling back to static data.</p>
          <p>Check browser console for error messages.</p>
        `;

        resultsDiv.innerHTML = html;

      } catch (error) {
        resultsDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
        console.error('Test failed:', error);
      }
    }

    testDataLoading();
  </script>
</body>
</html>