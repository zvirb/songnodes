# Mixcloud Parser Configuration
# =============================
# Mixcloud is a streaming platform for DJ mixes, radio shows, and podcasts.
# Tracklists are often displayed on mix pages.

source_name: "Mixcloud"
source_type: "dj_archive"
base_url: "https://www.mixcloud.com"

selectors:
  tracklist_container:
    - "css:div.tracklist"
    - "css:section.tracklist-section"
    - "css:div[data-testid='tracklist']"
    - "xpath://div[contains(@class, 'tracklist')]"

  track_row:
    - "css:div.tracklist-item"
    - "css:li.track-row"
    - "css:div[data-testid='track-row']"
    - "xpath://div[contains(@class, 'tracklist-item')]"

  track_title:
    - "css:span.track-title::text"
    - "css:a.track-name::text"
    - "css:div.track-info span::text"
    - "xpath:.//span[contains(@class, 'track-title')]/text()"

  artist_name:
    - "css:span.artist-name::text"
    - "css:a.artist-link::text"
    - "css:div.track-artist::text"
    - "xpath:.//span[contains(@class, 'artist')]/text()"

  timestamp:
    - "css:span.timestamp::text"
    - "css:time.track-time::text"
    - "css:span.start-time::text"
    - "xpath:.//span[contains(@class, 'timestamp')]/text()"

  venue:
    - "css:span.show-location::text"
    - "xpath://span[contains(@class, 'location')]/text()"

  date:
    - "css:time.upload-date::attr(datetime)"
    - "css:span.published-date::text"
    - "xpath://time/@datetime"

  setlist_name:
    - "css:h1.show-title::text"
    - "css:h1[data-testid='cloudcast-title']::text"
    - "css:header h1::text"
    - "xpath://h1[contains(@class, 'show-title')]/text()"

  notes:
    - "css:div.show-description::text"
    - "css:div.description p::text"
    - "xpath://div[contains(@class, 'description')]/text()"

regex_patterns:
  clean_track_title:
    - pattern: "^\\d+\\.\\s*"
      replace: ""
    - pattern: "\\[.*?\\]$"
      replace: ""
    - pattern: "\\s{2,}"
      replace: " "

  clean_artist_name:
    - pattern: "\\(.*?\\)"
      replace: ""
    - pattern: "^feat\\.?\\s+"
      replace: ""
      flags: "IGNORECASE"

  extract_timestamp:
    - pattern: "(\\d{1,2}:\\d{2}(?::\\d{2})?)"
      group: 1

  extract_date:
    - pattern: "(\\d{4}-\\d{2}-\\d{2})"
      group: 1

data_mapping:
  default_artist: ""
  default_genre: "DJ Mix"
  source_identifier: "mixcloud"
  date_format: "%Y-%m-%d"
  extract_timestamps: true
  enable_nlp_fallback: true

pagination:
  enabled: false

validation:
  min_tracks: 1
  max_tracks: 200
  require_venue: false
  require_date: false

rate_limiting:
  download_delay: 2.0
  randomize_delay: 0.3
  concurrent_requests: 1

metadata:
  created_by: "SongNodes Team"
  created_at: "2025-11-21"
  last_updated: "2025-11-21"
  notes: "Mixcloud DJ mix and radio show tracklists"
  source_url_pattern: "https://www.mixcloud.com/{username}/{show-slug}"
  example_urls:
    - "https://www.mixcloud.com/deadmau5/testpilot-live-from-resistance/"
    - "https://www.mixcloud.com/globaldnb/seba-guest-mix/"
